<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Freight Estimator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script>
      // when shipment type changes, auto-submit to refresh origin/destination lists
      function typeChanged() {
        document.getElementById('mainForm').submit();
      }
    </script>
</head>
<body>
  <h1>Freight Estimator</h1>

  <form id="mainForm" method="POST">
    <label>Shipment Type:</label>
    <select name="shipment_type" onchange="typeChanged()">
      {% for t in shipment_types %}
        <option value="{{ t }}" {% if t == selected_type %}selected{% endif %}>{{ t }}</option>
      {% endfor %}
    </select>

    <label>Origin:</label>
    <select name="origin" required>
      {% for o in origins %}
        <option value="{{ o }}">{{ o }}</option>
      {% endfor %}
    </select>

    <label>Destination:</label>
    <select name="destination" required>
      {% for d in destinations %}
        <option value="{{ d }}">{{ d }}</option>
      {% endfor %}
    </select>

    <button type="submit">Estimate</button>
  </form>

  {% if quote %}
    <div class="result">
      <p><strong>Type:</strong> {{ quote.shipment_type }}</p>
      <p><strong>Origin → Destination:</strong> {{ quote.origin }} → {{ quote.destination }}</p>
      {% if quote.distance_miles %}<p><strong>Distance:</strong> {{ quote.distance_miles }} mi</p>{% endif %}
      <p><strong>Average Total:</strong> ${{ '%.2f'|format(quote.average_total) }}</p>
    </div>
  {% endif %}

  <div class="map-container">
    {{ map_html|safe }}
  </div>
</body>
</html>
